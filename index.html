<!doctype html>
<html lang="en">
<head>

    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">


    <link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.3.1/css/bootstrap.min.css"
          integrity="sha384-ggOyR0iXCbMQv3Xipma34MD+dH/1fQ784/j6cY/iJTQUOhcWr7x9JvoRxT2MZw1T" crossorigin="anonymous">

    <title>HTAPP Methods</title>
</head>
<body>


<script src="https://code.jquery.com/jquery-3.3.1.slim.min.js"
        integrity="sha384-q8i/X+965DzO0rT7abK41JStQIAqVgRVzpbzo5smXKp4YfRvH+8abtTE1Pi6jizo"
        crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.14.7/umd/popper.min.js"
        integrity="sha384-UO2eT0CpHqdSJQ6hJty5KVphtPhzWj9WO1clHTMGa3JDZwrnQq4sF86dIHNDz0W1"
        crossorigin="anonymous"></script>
<script src="https://stackpath.bootstrapcdn.com/bootstrap/4.3.1/js/bootstrap.min.js"
        integrity="sha384-JjSmVgyd0p3pXB1rRibZUAYoIIy6OrQ6VrjIEaFf/nJGzIxFDsf4x0xIM+B07jRM"
        crossorigin="anonymous"></script>


<div class="container-fluid">
    <div class="row">
        <div class="col">
            <h1>A single-cell and single-nucleus RNA-Seq toolbox for fresh and frozen human tumors</h1>
            <h2>Comprehensive analysis figures for each tumor sample analyzed as part of this study</h2>
            <h2><a href="https://www.biorxiv.org/content/10.1101/761429v1">bioRxiv preprint</a></h2>
        </div>
    </div>
    <div class="row">
        <div class="col" style="max-width: 1400px;">
            <a name="samples"></a>
            <div class="table-responsive-sm">
                <table class="table table-bordered table-hover table-sm">
                    <thead>
                    <tr>
                        <th>Cancer Type</th>
                        <th>Origin</th>
                        <th>Age</th>
                        <th>Patients</th>
                        <th>Cells or Nuclei</th>
                        <th>Sample ID</th>
                        <th>Sample Type</th>
                        <th>Protocols Tested</th>
                    </tr>
                    </thead>
                    <tbody id="samples-content">
                    </tbody>
                </table>
            </div>
        </div>

    </div>
    <div class="row">
        <div class="col">


            <div style="position:relative;" id="image-wrapper">
                <div id="loading" style="display: none;">Loading...</div>
                <div id="controls" style="display: none;">
                    <div style="position:absolute;left:0px;top:0px;z-index: 1;">
                        <a href="#samples">
                            <div style="width: 28px;height:32px;display: inline-block;">
                                <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512">
                                    <path d="M256 504c137 0 248-111 248-248S393 8 256 8 8 119 8 256s111 248 248 248zm0-448c110.5 0 200 89.5 200 200s-89.5 200-200 200S56 366.5 56 256 145.5 56 256 56zm20 328h-40c-6.6 0-12-5.4-12-12V256h-67c-10.7 0-16-12.9-8.5-20.5l99-99c4.7-4.7 12.3-4.7 17 0l99 99c7.6 7.6 2.2 20.5-8.5 20.5h-67v116c0 6.6-5.4 12-12 12z"/>
                                </svg>
                            </div>
                            Back to table</a>
                    </div>

                    <div style="position:absolute;left:70px;top:30px;z-index: 1;">
                        <a id="previous" href="#">
                            <div style="width: 28px;height:32px;display: inline-block;">
                                <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512">
                                    <path d="M8 256c0 137 111 248 248 248s248-111 248-248S393 8 256 8 8 119 8 256zm448 0c0 110.5-89.5 200-200 200S56 366.5 56 256 145.5 56 256 56s200 89.5 200 200zm-72-20v40c0 6.6-5.4 12-12 12H256v67c0 10.7-12.9 16-20.5 8.5l-99-99c-4.7-4.7-4.7-12.3 0-17l99-99c7.6-7.6 20.5-2.2 20.5 8.5v67h116c6.6 0 12 5.4 12 12z"/>
                                </svg>
                            </div>
                        </a>
                    </div>
                    <div style="position:absolute;left:105px;top:30px;z-index: 1;">
                        <a id="next" href="#">
                            <div style="width: 28px;height:32px;display: inline-block;">
                                <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512">
                                    <path d="M504 256C504 119 393 8 256 8S8 119 8 256s111 248 248 248 248-111 248-248zm-448 0c0-110.5 89.5-200 200-200s200 89.5 200 200-89.5 200-200 200S56 366.5 56 256zm72 20v-40c0-6.6 5.4-12 12-12h116v-67c0-10.7 12.9-16 20.5-8.5l99 99c4.7 4.7 4.7 12.3 0 17l-99 99c-7.6 7.6-20.5 2.2-20.5-8.5v-67H140c-6.6 0-12-5.4-12-12z"/>
                                </svg>
                            </div>
                        </a>
                    </div>
                </div>
                <div style="position:absolute;left:0;top:-15px;" id="sample-image"></div>
            </div>
        </div>
    </div>
</div>

<script>
    var json = [
        {
            "Cancer Type": "Non-small cell lung carcinoma (NSCLC)",
            "Origin": "Epithelial",
            "Age": "Adult",
            "Patients": 2,
            "Cells or Nuclei": "Cells",
            "Sample ID": "NSCLC14",
            "Sample Type": "Resection",
            "Protocols Tested": "C4 / PDEC / LE"
        },
        {
            "Cancer Type": "",
            "Origin": "",
            "Age": "",
            "Patients": "",
            "Cells or Nuclei": "Cells",
            "Sample ID": "NSCLC17",
            "Sample Type": "Resection",
            "Protocols Tested": "PDEC / cd45n"
        },
        {
            "Cancer Type": "Neuroblastoma (NB)",
            "Origin": "Neuroendocrine",
            "Age": "Pediatric",
            "Patients": 4,
            "Cells or Nuclei": "Cells",
            "Sample ID": "HTAPP-312-SMP-901",
            "Sample Type": "Biopsy",
            "Protocols Tested": "C4"
        },
        {
            "Cancer Type": "",
            "Origin": "",
            "Age": "",
            "Patients": "",
            "Cells or Nuclei": "Cells",
            "Sample ID": "HTAPP-312-SMP-902",
            "Sample Type": "Resection",
            "Protocols Tested": "C4"
        },
        {
            "Cancer Type": "",
            "Origin": "",
            "Age": "",
            "Patients": "",
            "Cells or Nuclei": "Cells",
            "Sample ID": "HTAPP-656-SMP-3481",
            "Sample Type": "Resection",
            "Protocols Tested": "C4"
        },
        {
            "Cancer Type": "",
            "Origin": "",
            "Age": "",
            "Patients": "",
            "Cells or Nuclei": "Cells",
            "Sample ID": "O-PDX1",
            "Sample Type": "O-PDX",
            "Protocols Tested": "Papain Kit"
        },
        {
            "Cancer Type": "",
            "Origin": "",
            "Age": "",
            "Patients": "",
            "Cells or Nuclei": "Nuclei",
            "Sample ID": "HTAPP-244-SMP-451",
            "Sample Type": "Resection",
            "Protocols Tested": "EZ / CST / NST / TST"
        },
        {
            "Cancer Type": "",
            "Origin": "",
            "Age": "",
            "Patients": "",
            "Cells or Nuclei": "Nuclei",
            "Sample ID": "HTAPP-656-SMP-3481",
            "Sample Type": "Resection",
            "Protocols Tested": "TST"
        },
        {
            "Cancer Type": "",
            "Origin": "",
            "Age": "",
            "Patients": "",
            "Cells or Nuclei": "Nuclei",
            "Sample ID": "O-PDX1",
            "Sample Type": "O-PDX",
            "Protocols Tested": "TST"
        },
        {
            "Cancer Type": "Metastatic breast cancer (MBC)",
            "Origin": "Epithelial",
            "Age": "Adult",
            "Patients": 6,
            "Cells or Nuclei": "Cells",
            "Sample ID": "HTAPP-254-SMP-571",
            "Sample Type": "Resection",
            "Protocols Tested": "LD"
        },
        {
            "Cancer Type": "",
            "Origin": "",
            "Age": "",
            "Patients": "",
            "Cells or Nuclei": "Cells",
            "Sample ID": "HTAPP-735-SMP-3841",
            "Sample Type": "Biopsy",
            "Protocols Tested": "LD"
        },
        {
            "Cancer Type": "",
            "Origin": "",
            "Age": "",
            "Patients": "",
            "Cells or Nuclei": "Cells",
            "Sample ID": "HTAPP-285-SMP-751",
            "Sample Type": "Biopsy",
            "Protocols Tested": "LD"
        },
        {
            "Cancer Type": "",
            "Origin": "",
            "Age": "",
            "Patients": "",
            "Cells or Nuclei": "Cells",
            "Sample ID": "HTAPP-963-SMP-4741",
            "Sample Type": "Biopsy",
            "Protocols Tested": "LD"
        },
        {
            "Cancer Type": "",
            "Origin": "",
            "Age": "",
            "Patients": "",
            "Cells or Nuclei": "Nuclei",
            "Sample ID": "HTAPP-394-SMP-1561",
            "Sample Type": "Resection",
            "Protocols Tested": "CST / NST"
        },
        {
            "Cancer Type": "",
            "Origin": "",
            "Age": "",
            "Patients": "",
            "Cells or Nuclei": "Nuclei",
            "Sample ID": "HTAPP-589-SMP-2851",
            "Sample Type": "Resection",
            "Protocols Tested": "CST / TST"
        },
        {
            "Cancer Type": "",
            "Origin": "",
            "Age": "",
            "Patients": "",
            "Cells or Nuclei": "Nuclei",
            "Sample ID": "HTAPP-963-SMP-4741",
            "Sample Type": "Biopsy",
            "Protocols Tested": "CST / TST"
        },
        {
            "Cancer Type": "Glioblastoma",
            "Origin": "Neuronal",
            "Age": "Adult",
            "Patients": 1,
            "Cells or Nuclei": "Cells",
            "Sample ID": "GBM125",
            "Sample Type": "Resection",
            "Protocols Tested": "BTD Kit"
        },
        {
            "Cancer Type": "High-grade glioma",
            "Origin": "Neuronal",
            "Age": "Pediatric",
            "Patients": "",
            "Cells or Nuclei": "Nuclei",
            "Sample ID": "HTAPP-443-SMP-5491",
            "Sample Type": "Resection",
            "Protocols Tested": "CST"
        },
        {
            "Cancer Type": "Chronic Lymphocytc Leukemia (CLL)",
            "Origin": "Hematopoietic",
            "Age": "Adult",
            "Patients": 1,
            "Cells or Nuclei": "Cells",
            "Sample ID": "CLL1",
            "Sample Type": "Blood draw",
            "Protocols Tested": "fresh"
        },
        {
            "Cancer Type": "",
            "Origin": "",
            "Age": "",
            "Patients": "",
            "Cells or Nuclei": "Nuclei",
            "Sample ID": "CLL1",
            "Sample Type": "Blood draw",
            "Protocols Tested": "TST"
        },
        {
            "Cancer Type": "Ovarian",
            "Origin": "Epithelial",
            "Age": "Adult",
            "Patients": 3,
            "Cells or Nuclei": "Cells",
            "Sample ID": "HTAPP-624-SMP-3212",
            "Sample Type": "Resection",
            "Protocols Tested": "MHTD Kit"
        },
        {
            "Cancer Type": "",
            "Origin": "",
            "Age": "",
            "Patients": "",
            "Cells or Nuclei": "Cells",
            "Sample ID": "HTAPP-727-SMP-3781",
            "Sample Type": "Ascites",
            "Protocols Tested": "MHTD Kit / cd45n"
        },
        {
            "Cancer Type": "",
            "Origin": "",
            "Age": "",
            "Patients": "",
            "Cells or Nuclei": "Nuclei",
            "Sample ID": "HTAPP-316-SMP-991",
            "Sample Type": "Resection",
            "Protocols Tested": "CST / NST / TST"
        },
        {
            "Cancer Type": "Melanoma",
            "Origin": "Melanocytes",
            "Age": "Adult",
            "Patients": 2,
            "Cells or Nuclei": "Nuclei",
            "Sample ID": "MEL128",
            "Sample Type": "Resection",
            "Protocols Tested": "TST"
        },
        {
            "Cancer Type": "",
            "Origin": "",
            "Age": "",
            "Patients": "",
            "Cells or Nuclei": "Nuclei",
            "Sample ID": "MEL112",
            "Sample Type": "Resection",
            "Protocols Tested": "TST"
        },
        {
            "Cancer Type": "Sarcoma",
            "Origin": "Mesenchymal",
            "Age": "Pediatric",
            "Patients": 2,
            "Cells or Nuclei": "Nuclei",
            "Sample ID": "HTAPP-951-SMP-4652",
            "Sample Type": "Resection",
            "Protocols Tested": "CST / TST"
        },
        {
            "Cancer Type": "",
            "Origin": "",
            "Age": "",
            "Patients": "",
            "Cells or Nuclei": "Nuclei",
            "Sample ID": "HTAPP-975-SMP-4771",
            "Sample Type": "Resection",
            "Protocols Tested": "TST"
        }
    ];
    var html = [];
    var fields = ["Cancer Type",
        "Origin",
        "Age",
        "Patients",
        "Cells or Nuclei",
        "Sample ID",
        "Sample Type",
        "Protocols Tested"];
    json.forEach(function (value) {
        html.push('<tr>');
        fields.forEach(function (field) {
            html.push('<td>');
            if (field === "Sample ID") {
                var prefix = value['Cells or Nuclei'] + '/';
                var link = prefix + value[field] + '.pdf.png';
                html.push('<a class="details-link" data-link="' + link + '" href="image.html?image=' + link + '">');
            }
            html.push(value[field]);
            if (field === "Sample ID") {
                html.push('</a>');
            }
            html.push('</td>');
        });

        html.push('</tr>');
    });
    var currentImage = null;

    function getImageIndex() {
        for (let i = 0; i < json.length; i++) {
            var value = json[i];
            var link = value['Cells or Nuclei'] + '/' + value['Sample ID'] + '.pdf.png';
            if (link === currentImage) {
                return i;

            }
        }
        return -1;
    }

    $('#samples-content').html(html.join(''));
    $('#previous').on('click', function (e) {
        e.preventDefault();
        nextImage(false);
    });
    $('#next').on('click', function (e) {
        e.preventDefault();
        nextImage(true);

    });

    function nextImage(next) {
        var index = getImageIndex();
        if (next) {
            index--;
            if (index === -1) {
                index = json.length - 1;
            }
        } else {
            index++;
            if (index === json.length) {
                index = 0;
            }
        }
        var value = json[index];
        showImage(value['Cells or Nuclei'] + '/' + value['Sample ID'] + '.pdf.png');
    }

    var $sampleImage = $('#sample-image');
    var $loading = $('#loading');
    var $controls = $('#controls');


    function showImage(link, scroll) {
        $loading.show();
        $sampleImage.hide();
        $controls.hide();

        currentImage = link;
        var $img = $('<img src="' + link + '">');
        $sampleImage.html($img);
        $img[0].onload = function () {
            $controls.show();
            $loading.hide();
            $sampleImage.show();
            if (scroll) {
                var elementPosition = $controls[0].getBoundingClientRect().top;
                var offsetPosition = elementPosition - 30;
                window.scrollTo({
                    top: offsetPosition,
                });
            }
        };
    }

    $('.details-link').on('click', function (e) {
        e.preventDefault();
        var link = $(e.target).data('link');
        showImage(link, true);
    });
</script>
</body>
</html>